<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Daniela Palleschi">

<title>Data Wrangling 2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="09-wrangling_2_en_files/libs/clipboard/clipboard.min.js"></script>
<script src="09-wrangling_2_en_files/libs/quarto-html/quarto.js"></script>
<script src="09-wrangling_2_en_files/libs/quarto-html/popper.min.js"></script>
<script src="09-wrangling_2_en_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="09-wrangling_2_en_files/libs/quarto-html/anchor.min.js"></script>
<link href="09-wrangling_2_en_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="09-wrangling_2_en_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="09-wrangling_2_en_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="09-wrangling_2_en_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="09-wrangling_2_en_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

<script src="09-wrangling_2_en_files/libs/kePrint-0.0.1/kePrint.js"></script>
<link href="09-wrangling_2_en_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Data Wrangling 2</h1>
<p class="subtitle lead">Datenbereinigung (Data tidying)</p>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Daniela Palleschi </p>
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Humboldt-Universität zu Berlin
          </p>
      </div>
    </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">Wed den 13.12.2023</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">Tue den 12.12.2023</p>
    </div>
  </div>
    
  </div>
  

</header>

<section id="learning-objectives" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="learning-objectives">Learning objectives</h2>
<p>Today we will learn…</p>
<ul>
<li>about wide versus long data</li>
<li>how to make wide data longer</li>
<li>how to make long data wider</li>
</ul>
<section id="resources" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="resources">Resources</h3>
<p>The suggested resources for this topic are <a href="https://r4ds.hadley.nz/data-tidy">Chapter 6 (Data tidying)</a> in <span class="citation" data-cites="wickham_r_2023">@wickham_r_2023</span>, and <a href="https://psyteachr.github.io/ads-v2/08-tidy.html">Chapter 8 (Data tidying)</a> in <span class="citation" data-cites="nordmann_applied_2022">@nordmann_applied_2022</span>.</p>
</section>
</section>
<section id="review" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="review">Review</h2>
<p>In the last chapter we learned about descriptive statistics, specifically measures of central tendency (mean, median, mode) and dispersion (range, standard deviation). We also saw how to compute these values with base R (e.g., <code>mean()</code>, <code>sd()</code>) and the <code>tidyverse</code> (e.g., <code>summarise()</code>), and by groups (<code>summarise(.by = )</code>).</p>
<p>In this chapter we’ll review the concept of tidy data, and see how to organise and re-arrange our data so that it is tidy.</p>
</section>
<section id="set-up" class="level2">
<h2 class="anchored" data-anchor-id="set-up">Set-up</h2>
<p>We’ll need the packages <code>tidyverse</code>, <code>here</code>, and <code>janitor</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               here,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>               janitor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We’ll use the <code>languageR_english.csv</code> dataset (in <code>daten</code> folder).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>df_eng <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">here</span>(<span class="st">"daten"</span>, <span class="st">"languageR_english.csv"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(word) <span class="sc">|&gt;</span> </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">rt_lexdec =</span> r_tlexdec,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">rt_naming =</span> r_tnaming</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="tidy-workflow" class="level2">
<h2 class="anchored" data-anchor-id="tidy-workflow">Tidy workflow</h2>
<p><a href="#fig-workflow">Figure&nbsp;1</a> shows an overview of the typical data science process, whereby we import our data, tidy it, then work through a cycle of transforming, visualising, and modelling before finally communicating your findings.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-workflow" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="09-wrangling_2_en_files/figure-html/fig-workflow-1.png" style="height:100.0%" width="752" class="figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;1: <a href="https://r4ds.hadley.nz/intro.html">Image source:</a> <span class="citation" data-cites="wickham_r_nodate">@wickham_r_nodate</span> (all rights reserved)</figcaption>
</figure>
</div>
</div>
</div>
<p>We’ve already seen how to import our data (<code>readr::read_csv</code>), transform (<code>dplyr</code> package), and visualise (<code>ggplot</code> package) data. But we’ve only seen tidy data so far, so we haven’t needed to perform the ‘tidy’ step.</p>
</section>
<section id="tidy-data" class="level2">
<h2 class="anchored" data-anchor-id="tidy-data">Tidy data</h2>
<p>The same data can be representing multiple ways. The datasets below all show the same values of four variables: <code>country</code>, <code>year</code>, <code>popuplation</code>, and number of tuberculosis <code>cases</code>. Each dataset organises the values differently. Take a moment to consider the different options. Which is easiest to read?</p>
<div class="cell" data-output-location="fragment">
<div class="cell-output-display">
<div id="tbl-1" class="anchored">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Table&nbsp;1: Tabelle 1</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">country</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">year</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">cases</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">population</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Afghanistan</td>
<td style="text-align: right;">1999</td>
<td style="text-align: right;">745</td>
<td style="text-align: right;">19987071</td>
</tr>
<tr class="even">
<td style="text-align: left;">Afghanistan</td>
<td style="text-align: right;">2000</td>
<td style="text-align: right;">2666</td>
<td style="text-align: right;">20595360</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Brazil</td>
<td style="text-align: right;">1999</td>
<td style="text-align: right;">37737</td>
<td style="text-align: right;">172006362</td>
</tr>
<tr class="even">
<td style="text-align: left;">Brazil</td>
<td style="text-align: right;">2000</td>
<td style="text-align: right;">80488</td>
<td style="text-align: right;">174504898</td>
</tr>
<tr class="odd">
<td style="text-align: left;">China</td>
<td style="text-align: right;">1999</td>
<td style="text-align: right;">212258</td>
<td style="text-align: right;">1272915272</td>
</tr>
<tr class="even">
<td style="text-align: left;">China</td>
<td style="text-align: right;">2000</td>
<td style="text-align: right;">213766</td>
<td style="text-align: right;">1280428583</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<div class="cell" data-output-location="fragment">
<div class="cell-output-display">
<div id="tbl-2" class="anchored">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Table&nbsp;2: Tabelle 2</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">country</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">year</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">type</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Afghanistan</td>
<td style="text-align: right;">1999</td>
<td style="text-align: left;">cases</td>
<td style="text-align: right;">745</td>
</tr>
<tr class="even">
<td style="text-align: left;">Afghanistan</td>
<td style="text-align: right;">1999</td>
<td style="text-align: left;">population</td>
<td style="text-align: right;">19987071</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Afghanistan</td>
<td style="text-align: right;">2000</td>
<td style="text-align: left;">cases</td>
<td style="text-align: right;">2666</td>
</tr>
<tr class="even">
<td style="text-align: left;">Afghanistan</td>
<td style="text-align: right;">2000</td>
<td style="text-align: left;">population</td>
<td style="text-align: right;">20595360</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Brazil</td>
<td style="text-align: right;">1999</td>
<td style="text-align: left;">cases</td>
<td style="text-align: right;">37737</td>
</tr>
<tr class="even">
<td style="text-align: left;">Brazil</td>
<td style="text-align: right;">1999</td>
<td style="text-align: left;">population</td>
<td style="text-align: right;">172006362</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Brazil</td>
<td style="text-align: right;">2000</td>
<td style="text-align: left;">cases</td>
<td style="text-align: right;">80488</td>
</tr>
<tr class="even">
<td style="text-align: left;">Brazil</td>
<td style="text-align: right;">2000</td>
<td style="text-align: left;">population</td>
<td style="text-align: right;">174504898</td>
</tr>
<tr class="odd">
<td style="text-align: left;">China</td>
<td style="text-align: right;">1999</td>
<td style="text-align: left;">cases</td>
<td style="text-align: right;">212258</td>
</tr>
<tr class="even">
<td style="text-align: left;">China</td>
<td style="text-align: right;">1999</td>
<td style="text-align: left;">population</td>
<td style="text-align: right;">1272915272</td>
</tr>
<tr class="odd">
<td style="text-align: left;">China</td>
<td style="text-align: right;">2000</td>
<td style="text-align: left;">cases</td>
<td style="text-align: right;">213766</td>
</tr>
<tr class="even">
<td style="text-align: left;">China</td>
<td style="text-align: right;">2000</td>
<td style="text-align: left;">population</td>
<td style="text-align: right;">1280428583</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<div class="cell" data-output-location="fragment">
<div class="cell-output-display">
<div id="tbl-3" class="anchored">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Table&nbsp;3: Tabelle 3</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">country</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">year</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">rate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Afghanistan</td>
<td style="text-align: right;">1999</td>
<td style="text-align: left;">745/19987071</td>
</tr>
<tr class="even">
<td style="text-align: left;">Afghanistan</td>
<td style="text-align: right;">2000</td>
<td style="text-align: left;">2666/20595360</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Brazil</td>
<td style="text-align: right;">1999</td>
<td style="text-align: left;">37737/172006362</td>
</tr>
<tr class="even">
<td style="text-align: left;">Brazil</td>
<td style="text-align: right;">2000</td>
<td style="text-align: left;">80488/174504898</td>
</tr>
<tr class="odd">
<td style="text-align: left;">China</td>
<td style="text-align: right;">1999</td>
<td style="text-align: left;">212258/1272915272</td>
</tr>
<tr class="even">
<td style="text-align: left;">China</td>
<td style="text-align: right;">2000</td>
<td style="text-align: left;">213766/1280428583</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>You likely found <a href="#tbl-1">Table&nbsp;1</a> easiest to read. This is because it follows the three rules for tidy data (visualised in <a href="#fig-tidy">Figure&nbsp;2</a>):</p>
<ol type="1">
<li>Each variable is a column, each column is a variable</li>
<li>Each observation is a row, each row is an observation</li>
<li>Each value is a cell, each cell is a single value</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-tidy" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="09-wrangling_2_en_files/figure-html/fig-tidy-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;2: <a href="https://r4ds.hadley.nz/data-tidy.html">Image source:</a> <span class="citation" data-cites="wickham_r_nodate">@wickham_r_nodate</span> (all rights reserved)</figcaption>
</figure>
</div>
</div>
</div>
<p>In <a href="#tbl-1">Table&nbsp;1</a>, each column represents a variable: <code>country</code>, <code>year</code>, <code>population</code> and <code>case</code>. Each row represents a single observation: a country in a given year. And lastly, each cell contained a single value.</p>
<section id="why-tidy-data" class="level3">
<h3 class="anchored" data-anchor-id="why-tidy-data">Why tidy data?</h3>
<blockquote class="blockquote">
<p>“<strong>Happy families</strong> are all alike; every <strong>unhappy family</strong> is unhappy in its own way.” — Leo Tolstoy</p>
</blockquote>
<blockquote class="blockquote">
<p>“<strong>Tidy datasets</strong> are all alike, but every <strong>untidy dataset</strong> is untidy in its own way.” — Hadley Wickham</p>
</blockquote>
<p>Once you have tidy data, you’ll spend less time trying to get your data in the right shape to do what you want. Data tidying requires some work up front, but is helpful in the long run.</p>
<p>There are two main advantages to working with tidy data:</p>
<ol type="1">
<li>working with a consistent data structure allows us to adopt conventions
<ul>
<li>since tidy data is the generally agreed upon data structure, conventions are built on the assumption of this structure</li>
<li>so tools have an underlying uniformity</li>
</ul></li>
<li><code>R</code>’s vectorised nature can shine
<ul>
<li>most built-in R funtions work with <em>vector values</em> (and columns are essentially vectors)</li>
<li>all packages in the <code>tidyverse</code> are designed to work with tidy data (e.g., <code>ggplot2</code> and <code>dplyr</code>)</li>
</ul></li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Review: Vectors
</div>
</div>
<div class="callout-body-container callout-body">
<p>Vectors are the most basic data object type in R. A vector contains data of the same type, and is essentially a list. You can create a vector using the <code>c()</code> function, for example.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>vector1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">7</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>vector2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="st">"c"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>vector1</code> will contain numeric values, because all elements are numbers. <code>vector2</code> will contain all character values (i.e., text), because there is a singlular unambiguous character element (<code>"c"</code>). So, R reads all elements as character type. We can create a dataframe from vectors of the same length using the <code>tibble()</code> function, for example.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(vector1,vector2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  vector1 vector2
    &lt;dbl&gt; &lt;chr&gt;  
1       2 2      
2       3 3      
3       4 4      
4       6 6      
5       7 c      </code></pre>
</div>
</div>
</div>
</div>
<p>Most data “in the wild” is untidy. Data is often first organised for some goal other than analysis. This goal is usually to facilitate data entry: we want to make it easy to document our observations first. Most people aren’t familiar with the principles of tidy data, only after spending <em>a lot</em> of time with data does it become obvious why tidy data is necessary. This means most <em>real</em> analyses will require at least some tidying.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<a href="#exm-tidy">Aufgabe&nbsp;1</a>: Tidy data
</div>
</div>
<div class="callout-body-container callout-body">
<div id="exm-tidy" class="custom theorem example">
<p><span class="theorem-title"><strong>Example 1 </strong></span>&nbsp;</p>
<div class="nonincremental">
<ol type="1">
<li>Go back to Tables 1-3. For each table, describe what each observation and each column represents.</li>
<li>Sketch out the process you’d use to calculate the rate for <code>table1.</code> You will need just one verb that:
<ul>
<li>creates a new variable (call it <code>rate</code>) that contains:
<ul>
<li>the number of TB <code>cases</code> per country per year, divided by</li>
<li>the matching <code>population</code> per country per year,</li>
<li>multiply by <code>10000</code></li>
</ul></li>
<li>hint: Which <code>dplyr</code> verb creates new variables? (Look back at week 5)</li>
</ul></li>
<li>Look at tables 2 and 3. Would it have been as easy to calculate <code>rate</code> with these data structures?</li>
</ol>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="data-tidying" class="level2">
<h2 class="anchored" data-anchor-id="data-tidying">Data tidying</h2>
<p>Data tidying essentially consists of transforming wide data to long data and long data to wide data (among other steps). The outcome is tidy data, in which each column represents a variable and each row an observation. How exactly we define an observation is dependent on what exactly we’re trying to achieve, and can change between one analysis step and another.</p>
<section id="data-tidying-with-the-tidyverse" class="level3">
<h3 class="anchored" data-anchor-id="data-tidying-with-the-tidyverse">Data tidying with the <code>tidyverse</code></h3>
<p>The <code>tidyr</code> package from the <code>tidyverse</code> has two useful functions for transposing our data:</p>
<ul>
<li><code>pivot_longer()</code>: make wide data longer</li>
<li><code>pivot_wider()</code>: make long data wider</li>
</ul>
<p>We often need to convert between these formats to do different types of summaries or visualisation. But what exactly are wide and long data?</p>
<div class="cell" data-layout-align="center" data-fig-cap-location="bottom">
<div class="cell-output-display">
<div id="fig-pivot-html" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="09-wrangling_2_en_files/figure-html/fig-pivot-html-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;3: die berühmteste Verwendung des Wortes Pivot (zumindest für Millenials) (<a href="https://www.youtube.com/watch?v=8w3wmQAMoxQ">Friends</a>)</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="wide-versus-long-data" class="level2">
<h2 class="anchored" data-anchor-id="wide-versus-long-data">Wide versus long data</h2>
<p>In wide data, all of the observations about one thing are in the same row. Wide data is <em>usually</em> not tidy. In long data, each observation is on a separate row. Long data is <em>usually</em> tidy. Let’s start with the most typical case: turning wide data into long data.</p>
</section>
<section id="lengthening-data-df_eng" class="level2">
<h2 class="anchored" data-anchor-id="lengthening-data-df_eng">Lengthening data: <code>df_eng</code></h2>
<ul>
<li>in the <code>languageR_english.csv</code> dataset
<ul>
<li>each row is an observation</li>
<li>the first column describes the participant’s age group</li>
<li>the columsn <code>word</code>, <code>length_in_letters</code>, <code>written_frequency</code>, and <code>word_category</code> describe properties of the stimulus for a given observation (i.e., the word)</li>
<li>we have 4568 observations</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>df_eng <span class="sc">%&gt;%</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="tbl-df_eng" class="anchored">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Table&nbsp;4: df_eng</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">age_subject</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">word</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">length_in_letters</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">written_frequency</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">word_category</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">rt_lexdec</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">rt_naming</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">young</td>
<td style="text-align: left;">ace</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4.219508</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">623.61</td>
<td style="text-align: right;">456.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">old</td>
<td style="text-align: left;">ace</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4.219508</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">775.67</td>
<td style="text-align: right;">607.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">young</td>
<td style="text-align: left;">act</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">8.118207</td>
<td style="text-align: left;">V</td>
<td style="text-align: right;">617.10</td>
<td style="text-align: right;">445.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">old</td>
<td style="text-align: left;">act</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">8.118207</td>
<td style="text-align: left;">V</td>
<td style="text-align: right;">715.52</td>
<td style="text-align: right;">639.7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">young</td>
<td style="text-align: left;">add</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">7.319203</td>
<td style="text-align: left;">V</td>
<td style="text-align: right;">575.70</td>
<td style="text-align: right;">467.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">old</td>
<td style="text-align: left;">add</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">7.319203</td>
<td style="text-align: left;">V</td>
<td style="text-align: right;">742.19</td>
<td style="text-align: right;">605.4</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<ul>
<li>is this data in <a href="#tbl-df_eng">Table&nbsp;4</a> tidy?</li>
<li>is this data too wide or too long?</li>
<li>how might we make this data longer?</li>
</ul>
<p>Whether or not we would wnat to lengthen this data depends on our task at hand. If we wanted to plot response times for the lexical decision task (<code>rt_lexdec</code>) alongside the response time for the naming task (<code>rt_naming</code>), we might want to include the two in <code>facet_wrap()</code>. However, <code>facet_wrap()</code> takes a <em>categorical</em> variable as its argument, and produces plots of each category. We would need to have a new variable, for example <code>response</code>, which contains the levels <code>lexdec</code> and <code>naming</code>, and another, for example <code>time</code>, that contains the response time. Let’s try doing that.</p>
<section id="pivot_longer" class="level3">
<h3 class="anchored" data-anchor-id="pivot_longer"><code>pivot_longer()</code></h3>
<p>The <code>tidyr</code> function <code>pivot_longer()</code> converts a wide data table to a longer format by converting the headers from specified columns into the values of new columns, and combining the values of those columns into a new condensed column.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>df_eng_long <span class="ot">&lt;-</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  df_eng <span class="sc">%&gt;%</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"rt_"</span>), </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"response"</span>, </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"time"</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The output of the first 12 rows (after some additional formatting to make a pretty table) should look like <a href="#tbl-longer">Table&nbsp;5</a>.</p>
<div class="cell" data-output-location="column-fragment">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>df_eng_long <span class="sc">%&gt;%</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="at">n =</span> <span class="dv">12</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="tbl-longer" class="anchored">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Table&nbsp;5: A pivoted version of <code>df_billboard</code> (first 10 rows)</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">age_subject</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">word</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">length_in_letters</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">written_frequency</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">word_category</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">response</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">young</td>
<td style="text-align: left;">ace</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4.219508</td>
<td style="text-align: left;">N</td>
<td style="text-align: left;">rt_lexdec</td>
<td style="text-align: right;">623.61</td>
</tr>
<tr class="even">
<td style="text-align: left;">young</td>
<td style="text-align: left;">ace</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4.219508</td>
<td style="text-align: left;">N</td>
<td style="text-align: left;">rt_naming</td>
<td style="text-align: right;">456.30</td>
</tr>
<tr class="odd">
<td style="text-align: left;">old</td>
<td style="text-align: left;">ace</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4.219508</td>
<td style="text-align: left;">N</td>
<td style="text-align: left;">rt_lexdec</td>
<td style="text-align: right;">775.67</td>
</tr>
<tr class="even">
<td style="text-align: left;">old</td>
<td style="text-align: left;">ace</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4.219508</td>
<td style="text-align: left;">N</td>
<td style="text-align: left;">rt_naming</td>
<td style="text-align: right;">607.80</td>
</tr>
<tr class="odd">
<td style="text-align: left;">young</td>
<td style="text-align: left;">act</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">8.118207</td>
<td style="text-align: left;">V</td>
<td style="text-align: left;">rt_lexdec</td>
<td style="text-align: right;">617.10</td>
</tr>
<tr class="even">
<td style="text-align: left;">young</td>
<td style="text-align: left;">act</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">8.118207</td>
<td style="text-align: left;">V</td>
<td style="text-align: left;">rt_naming</td>
<td style="text-align: right;">445.80</td>
</tr>
<tr class="odd">
<td style="text-align: left;">old</td>
<td style="text-align: left;">act</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">8.118207</td>
<td style="text-align: left;">V</td>
<td style="text-align: left;">rt_lexdec</td>
<td style="text-align: right;">715.52</td>
</tr>
<tr class="even">
<td style="text-align: left;">old</td>
<td style="text-align: left;">act</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">8.118207</td>
<td style="text-align: left;">V</td>
<td style="text-align: left;">rt_naming</td>
<td style="text-align: right;">639.70</td>
</tr>
<tr class="odd">
<td style="text-align: left;">young</td>
<td style="text-align: left;">add</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">7.319203</td>
<td style="text-align: left;">V</td>
<td style="text-align: left;">rt_lexdec</td>
<td style="text-align: right;">575.70</td>
</tr>
<tr class="even">
<td style="text-align: left;">young</td>
<td style="text-align: left;">add</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">7.319203</td>
<td style="text-align: left;">V</td>
<td style="text-align: left;">rt_naming</td>
<td style="text-align: right;">467.80</td>
</tr>
<tr class="odd">
<td style="text-align: left;">old</td>
<td style="text-align: left;">add</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">7.319203</td>
<td style="text-align: left;">V</td>
<td style="text-align: left;">rt_lexdec</td>
<td style="text-align: right;">742.19</td>
</tr>
<tr class="even">
<td style="text-align: left;">old</td>
<td style="text-align: left;">add</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">7.319203</td>
<td style="text-align: left;">V</td>
<td style="text-align: left;">rt_naming</td>
<td style="text-align: right;">605.40</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>Let’s take a second to compare the values that we see in <a href="#tbl-longer">Table&nbsp;5</a> to those from the first 6 rows in <code>df_eng</code>, given in <a href="#tbl-df_eng">Table&nbsp;4</a>. Compare the values in the <code>df_eng</code> variable <code>rt_lexdec</code> (<a href="#tbl-df_eng">Table&nbsp;4</a>) to the <code>time</code> values when <code>response</code> is <code>rt_lexdec</code> (<a href="#tbl-longer">Table&nbsp;5</a>): they’re identical. Now what about <code>rt_naming</code> in both <a href="#tbl-df_eng">Table&nbsp;4</a> and <a href="#tbl-longer">Table&nbsp;5</a>? They’re also identical. This is an important realisation: we haven’t changed any data or observation values, we’ve just simply re-structured the organisation of the data points.</p>
<p>How did <code>pivot_longer()</code> do this? Here’s a breakdown of the arguments <code>pivot_longer()</code> takes (which you can also explore by running <code>?pivot_longer</code> in the Console):</p>
<ul>
<li><code>col =</code> specifies which columns need to be pivoted (should be a categorical variable)
<ul>
<li>takes the same syntax as <code>select()</code>, so we could use e.g., <code>starts_with("")</code></li>
</ul></li>
<li><code>names_to =</code> names the variable stored in the current column names, here it is <code>week</code></li>
<li><code>values_to =</code> names the variable stored int he cell values, which we name <code>rank</code></li>
<li>N.B., we had to wrap <code>week</code> and <code>rank</code> with quotation marks because they aren’t variable names <em>yet</em></li>
</ul>
<section id="plotting-our-tidy-data" class="level4">
<h4 class="anchored" data-anchor-id="plotting-our-tidy-data">Plotting our tidy data</h4>
<p>Now that we have the <code>response</code> data in one variable and the <code>time</code> data in another variable, let’s try to produce a plot where we have <code>age_subject</code> on the x-axis, <code>time</code> on the y-axis, and <code>response</code></p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-eng" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="09-wrangling_2_en_files/figure-html/fig-eng-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;4: Response times per age group for the lexical decision task vs.&nbsp;naming task</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<a href="#exm-tidy">Aufgabe&nbsp;1</a>: Tidy data
</div>
</div>
<div class="callout-body-container callout-body">
<div id="exm-help" class="custom theorem example">
<p><span class="theorem-title"><strong>Example 2 </strong></span>&nbsp;</p>
<div class="nonincremental">
<p>Recreate <a href="#fig-eng">Figure&nbsp;4</a></p>
</div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="widening-data-df_eng" class="level2">
<h2 class="anchored" data-anchor-id="widening-data-df_eng">Widening data: <code>df_eng</code></h2>
<p>The <code>tidyr</code> function <code>pivot_wider()</code> make datasets <em>wider</em> by increasing columns and reducing rows. This helps when one observation is spread across multiple rows. Although this type of data isn’t very common in the wild, it’s pretty common in governmental data for example.</p>
<p>We can again start with <code>df_eng</code> to make the data wider. For example, we could have a single row per <em>word</em>, wich a single variable for the <code>young</code> subject’s response and the <code>old</code> subject’s response.</p>
<section id="pivot_wider" class="level3">
<h3 class="anchored" data-anchor-id="pivot_wider"><code>pivot_wider()</code></h3>
<p>Pivot wider takes similar arguments to <code>pivot_longer()</code>, with some slight differences (e.g., <code>?pivot_wider</code>):</p>
<ul>
<li><code>id_cols</code>: identifying columns (which columns uniquely identify each observation?)</li>
<li><code>names_from</code>: what should we call the new column containing the previous column names (must be a categorical variable)?</li>
<li><code>names_prefix</code>: prefix for the new column names (optional)</li>
<li><code>values_from</code>: new column values</li>
</ul>
<p>Let’s create two new variables that take their names from <code>age_subject</code>, and their values from <code>rt_lexdec</code>. The result should look like <a href="#tbl-eng_wider">Table&nbsp;6</a>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>df_eng_wide <span class="ot">&lt;-</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  df_eng <span class="sc">%&gt;%</span>  </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>rt_naming) <span class="sc">|&gt;</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> age_subject,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> rt_lexdec,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_prefix =</span> <span class="st">"lexdec_"</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-eng_wider" class="anchored">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Table&nbsp;6: Wider <code>df_eng</code> data</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">word</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">length_in_letters</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">written_frequency</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">word_category</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lexdec_young</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lexdec_old</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ace</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4.219508</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">623.61</td>
<td style="text-align: right;">775.67</td>
</tr>
<tr class="even">
<td style="text-align: left;">act</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">8.118207</td>
<td style="text-align: left;">V</td>
<td style="text-align: right;">617.10</td>
<td style="text-align: right;">715.52</td>
</tr>
<tr class="odd">
<td style="text-align: left;">add</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">7.319203</td>
<td style="text-align: left;">V</td>
<td style="text-align: right;">575.70</td>
<td style="text-align: right;">742.19</td>
</tr>
<tr class="even">
<td style="text-align: left;">age</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">8.397959</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">592.42</td>
<td style="text-align: right;">748.37</td>
</tr>
<tr class="odd">
<td style="text-align: left;">aid</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">6.927558</td>
<td style="text-align: left;">V</td>
<td style="text-align: right;">541.67</td>
<td style="text-align: right;">824.76</td>
</tr>
<tr class="even">
<td style="text-align: left;">aide</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4.615120</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">693.50</td>
<td style="text-align: right;">895.29</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p><a href="#tbl-df_eng-2">Table&nbsp;7</a> shows the first 6 rows of the original dataset again.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-df_eng-2" class="anchored">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Table&nbsp;7: head(df_eng, n = 6)</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">age_subject</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">word</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">length_in_letters</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">written_frequency</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">word_category</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">rt_lexdec</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">rt_naming</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">young</td>
<td style="text-align: left;">ace</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4.219508</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">623.61</td>
<td style="text-align: right;">456.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">old</td>
<td style="text-align: left;">ace</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4.219508</td>
<td style="text-align: left;">N</td>
<td style="text-align: right;">775.67</td>
<td style="text-align: right;">607.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">young</td>
<td style="text-align: left;">act</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">8.118207</td>
<td style="text-align: left;">V</td>
<td style="text-align: right;">617.10</td>
<td style="text-align: right;">445.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">old</td>
<td style="text-align: left;">act</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">8.118207</td>
<td style="text-align: left;">V</td>
<td style="text-align: right;">715.52</td>
<td style="text-align: right;">639.7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">young</td>
<td style="text-align: left;">add</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">7.319203</td>
<td style="text-align: left;">V</td>
<td style="text-align: right;">575.70</td>
<td style="text-align: right;">467.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">old</td>
<td style="text-align: left;">add</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">7.319203</td>
<td style="text-align: left;">V</td>
<td style="text-align: right;">742.19</td>
<td style="text-align: right;">605.4</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>How is the data from <strong>?@tbl-eng-wide</strong> represented in <a href="#tbl-df_eng-2">Table&nbsp;7</a>?</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Where has <code>rt_naming</code> gone? We’ve removed it because it also has a single value per word per age group, so not removing it means we don’t change the length of our dataset (still one row per word per age group), we just change the width and introduce <code>NA</code> values for <code>lexdec_young</code> for old subjects and <code>NA</code> values for <code>lexdec_old</code> for young subjects.</p>
</div>
</div>
</section>
</section>
<section id="homework" class="level2">
<h2 class="anchored" data-anchor-id="homework">Homework</h2>
<p>We’ll stick with the <code>df_eng</code> dataset for these tasks.</p>
<ol type="1">
<li><p>Using <code>pivot_wider</code> to create <code>rt_naming</code> new variables: <code>naming_old</code> and <code>naming_young</code> which containg the naming response times for old and young participants, respectively. Hint: you will need to remove <code>rt_lexdec</code>. The resulting data frame should have 2284 observations and 6 variables.</p></li>
<li><p>Recreate <strong>?@fig-old_young</strong>. Hint: you will need <code>pivot_wider()</code>.</p></li>
</ol>
<div class="cell">
<div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'df_eng_wide' not found</code></pre>
</div>
</div>
<ol start="3" type="1">
<li><p>Why do we need out <code>df_eng_wide</code> dataset to produce <strong>?@fig-old_young</strong>? In other words, why is <code>df_eng_wide</code> the appropriate structure but not <code>df_eng_long</code> for such a scatterplot?</p></li>
<li><p>Using <code>df_eng_long</code> and the <code>summarise()</code> function we saw in the last section, reproduce the summary below:</p></li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  response   mean    sd
  &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt;
1 rt_lexdec  708.  115.
2 rt_naming  566.  101.</code></pre>
</div>
</div>
<p>Hint: do you need to remove <code>NA</code>s (we saw how to do this in the last section)?</p>
</section>
<section id="learning-objectives-1" class="level2 unnumbered unlisted">
<h2 class="unnumbered unlisted anchored" data-anchor-id="learning-objectives-1">Learning objectives 🏁</h2>
<p>Today we learned…</p>
<ul>
<li>about wide versus long data ✅</li>
<li>how to make wide data longer ✅</li>
<li>how to make long data wider ✅</li>
</ul>
</section>
<section id="session-info" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="session-info">Session Info</h2>
<p>Hergestellt mit R version 4.3.0 (2023-04-21) (Already Tomorrow) und RStudioversion 2023.9.0.463 (Desert Sunflower).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.3.0 (2023-04-21)
Platform: aarch64-apple-darwin20 (64-bit)
Running under: macOS Ventura 13.2.1

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRblas.0.dylib 
LAPACK: /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

time zone: Europe/Berlin
tzcode source: internal

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] janitor_2.2.0   here_1.0.1      lubridate_1.9.2 forcats_1.0.0  
 [5] stringr_1.5.0   dplyr_1.1.3     purrr_1.0.2     readr_2.1.4    
 [9] tidyr_1.3.0     tibble_3.2.1    ggplot2_3.4.3   tidyverse_2.0.0

loaded via a namespace (and not attached):
 [1] utf8_1.2.3        generics_0.1.3    xml2_1.3.4        stringi_1.7.12   
 [5] hms_1.1.3         digest_0.6.33     magrittr_2.0.3    evaluate_0.21    
 [9] grid_4.3.0        timechange_0.2.0  fastmap_1.1.1     rprojroot_2.0.3  
[13] jsonlite_1.8.7    httr_1.4.6        rvest_1.0.3       fansi_1.0.4      
[17] viridisLite_0.4.2 scales_1.2.1      cli_3.6.1         rlang_1.1.1      
[21] crayon_1.5.2      bit64_4.0.5       munsell_0.5.0     withr_2.5.0      
[25] yaml_2.3.7        tools_4.3.0       parallel_4.3.0    tzdb_0.4.0       
[29] colorspace_2.1-0  webshot_0.5.4     pacman_0.5.1      kableExtra_1.3.4 
[33] png_0.1-8         vctrs_0.6.3       R6_2.5.1          magick_2.7.4     
[37] lifecycle_1.0.3   snakecase_0.11.0  htmlwidgets_1.6.2 bit_4.0.5        
[41] vroom_1.6.3       pkgconfig_2.0.3   pillar_1.9.0      gtable_0.3.4     
[45] Rcpp_1.0.11       glue_1.6.2        systemfonts_1.0.4 highr_0.10       
[49] xfun_0.39         tidyselect_1.2.0  rstudioapi_0.14   knitr_1.44       
[53] farver_2.1.1      htmltools_0.5.5   labeling_0.4.3    svglite_2.1.1    
[57] rmarkdown_2.22    compiler_4.3.0   </code></pre>
</div>
</div>
</section>
<section id="literaturverzeichnis" class="level2 unlisted unnumbered" data-visibility="uncounted">
<h2 class="unlisted unnumbered anchored" data-visibility="uncounted" data-anchor-id="literaturverzeichnis">Literaturverzeichnis</h2>
<div id="refs" data-custom-style="Bibliography" role="list">

</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>